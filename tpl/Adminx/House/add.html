<layout name='layout' />

<form class="layui-form">
	<div class="layui-form-item">
		<label class="layui-form-label">标题</label>
		<div class="layui-input-block">
			<input type="text" name="title" lay-verify="required" placeholder="请输入标题" class="layui-input">
		</div>
	</div>

	<div class="layui-form-item">
		<?php if ($_SESSION['administrator']) {?>
		<label class="layui-form-label">城市</label>
		<div class="layui-input-inline">			
			<select name="cityID" lay-verify="required" lay-verType="tips" class="fsSelect fsDict" dict="city" addNull="1">
	      	</select>			
		</div>
		<?php }else{ ?>
		<input type="hidden" name="cityID" value="<{$user.cityID}>">
		<?php } ?>

		<label class="layui-form-label">分类</label>
		<div class="layui-input-inline">
			<select name="sort" id="sort" lay-verify="required">
	    	<option value="">==请选择==</option>
	        <volist name="category" id="vo">
	        <option value="<{$vo['id']}>"><{$vo['name']}></option>
	        </volist>
	        </select>
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">图片</label>
		<div class="layui-inline">
			<div class="insert-img" id="insert-img"></div>						
		</div>
		<input type="hidden" name="thumb" id="thumb">
		<button type="button" class="layui-btn"
		 id="muploud"
		 url="<{:U('Upload/image')}>"
		 size="5120"
		 exts="jpg|png|gif|jpeg"
		 accept="images"
		 tag="insert-img"
		 >上传图片</button> 
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">联系人</label>
		<div class="layui-input-inline">
			<input type="text" name="contact" class="layui-input">
		</div>

		<label class="layui-form-label">电话</label>
		<div class="layui-input-inline">
			<input type="text" name="phone" class="layui-input">
		</div>

		<label class="layui-form-label">微信</label>
		<div class="layui-input-inline">
			<input type="text" name="wechat" class="layui-input">
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">相关地址</label>
		<div class="layui-input-block">
			<input type="text" name="address" id="address" class="layui-input">
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">经度</label>
		<div class="layui-input-inline">
			<input type="text" name="longitude" class="layui-input">
		</div>

		<label class="layui-form-label">纬度</label>
		<div class="layui-input-inline">
			<input type="text" name="latitude" class="layui-input">
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">价格</label>
		<div class="layui-input-inline">
			<input type="text" name="price" placeholder="0代表面议" class="layui-input" lay-verify="required">
		</div>
	</div>	
	
	<div class="layui-form-item">
		<label class="layui-form-label">入住时间</label>
		<div class="layui-input-inline">
			<input type="text" name="Into" class="layui-input" >
		</div>

		<label class="layui-form-label">卧室数</label>
		<div class="layui-input-inline">
			<input type="text" name="bedrooms" class="layui-input" >
		</div>

		<label class="layui-form-label">停车位数</label>
		<div class="layui-input-inline">
			<input type="text" name="parks" class="layui-input" >
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">淋浴数</label>
		<div class="layui-input-inline">
			<input type="text" name="showers" class="layui-input" >
		</div>

		<label class="layui-form-label">卫生间数</label>
		<div class="layui-input-inline">

			<input type="text" name="toilets" class="layui-input" >
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">选择线路</label>
		<?php if ($_SESSION['administrator']) {?>
		<div class="layui-input-inline">			
			<select class="fsSelect" id="c1" dict="city" addNull="1" lay-filter="city">
	      	</select>			
		</div>
		<div class="layui-input-inline">			
			<select class="fsSelect" id="c2" lay-filter="subway">
	      	</select>			
		</div>
		<div class="layui-input-inline">			
			<select class="fsSelect" id="c3">
	      	</select>			
		</div>
		<?php }else{ ?>
		<div class="layui-input-inline">			
			<select id="c2" lay-filter="subway">
				<option value="">请选择</option>
				<volist name="subway" id="vo">
				<option value="<{$vo.id}>"><{$vo.name}></option>
				</volist>
	      	</select>			
		</div>
		<div class="layui-input-inline">			
			<select id="c3"></select>			
		</div>
		<?php } ?>
		<div class="layui-input-inline">
		<button type="button" class="layui-btn" id="addBtn">选择</button>
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">地铁</label>
		<div class="layui-input-block">
			<input type="text" name="subway" id="subway" class="layui-input">
		</div>		
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">设施</label>
		<div class="layui-input-block">
			<volist name="sheshi" id="vo">
			<input type="checkbox" name="facility[]" value="<{$vo.name}>" lay-skin="primary" title="<{$vo.name}>">
			</volist>
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">出租/出售</label>
		<div class="layui-input-inline">
			<select name="houseType" lay-filter="test">
				<option value="0">出租</option>
				<option value="1">出售</option>
	      	</select>
		</div>
		
		<div id="cz">
		<label class="layui-form-label">租期</label>
		<div class="layui-input-inline">
			<select name="remark[]" lay-verType="tips" class="fsSelect fsDict" dict="remarkType" addNull="1">
	      	</select>
		</div>
		</div>

		<div id="cs" style="display: none;">
		<label class="layui-form-label">卖家</label>
		<div class="layui-input-inline">
			<select name="remark[]" lay-verType="tips" class="fsSelect fsDict" dict="csType" addNull="1">
	      	</select>
		</div>
		</div>

		<label class="layui-form-label">类型</label>
		<div class="layui-input-inline">
			<select name="singleType" lay-verType="tips" class="fsSelect fsDict" dict="singleType" addNull="1">
	      	</select>
		</div>
	</div>

	<div class="layui-form-item layui-form-text">
		<label class="layui-form-label">描述</label>
		<div class="layui-input-block">
			<textarea name="detail" class="layui-textarea"></textarea>
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">生成静态</label>
		<div class="layui-input-block">
			<input type="checkbox" name="makeHtml" lay-skin="switch" lay-filter="html">
		</div>
	</div>

	<script>
	layui.use(['form'],function(){
		var form = layui.form;
		form.on('switch(html)', function(data){
			if (data.elem.checked){
				$("#contentBox").show();
				$(".edui-container").css("width","100%");
				$("#container").css("width","100%");
			}else{
				$("#contentBox").hide();
			}
		});
		form.on('select(test)', function(data){
			if (data.value==0){
				$("#cz").show();
				$("#cs").hide();
			}else{
				$("#cz").hide();
				$("#cs").show();
			}
		});		
	})
	</script>

	<div class="layui-form-item layui-form-text" id="contentBox" hidden>
		<div class="layui-form-item">
		<label class="layui-form-label">留言</label>
			<div class="layui-input-inline">
				<input type="radio" name="feedback" value="0" title="关闭" checked>
				<input type="radio" name="feedback" value="1" title="开启">
			</div>
		</div>
		<label class="layui-form-label">正文</label>
		<div class="layui-input-block">
			<textarea name="content" id="container" lay-verify="content">文章正文</textarea>
			<script type="text/javascript" src="<{:C('UE_CONFIG.uedir')}>/my.config.js"></script>
			<script type="text/javascript" src="<{:C('UE_CONFIG.uedir')}>/ueditor.all.min.js"></script>
			<script type="text/javascript" src="<{:C('UE_CONFIG.uedir')}>/lang/zh-cn/zh-cn.js"></script>
			<script type="text/javascript">
			var editor = UE.getEditor('container');
			</script>
		</div>
	</div>
	
	<hr>
	
	<div class="layui-form-item">
		<label class="layui-form-label"></label>
	    <button class="layui-btn" lay-submit="" lay-filter="save" url="<{:U('House/add')}>">新增</button>
	    <button type="button" class="layui-btn layui-btn-primary" function="close">关闭</button>
	</div>
</form>
<script type="text/javascript" src="<{:RES}>/js/upload.js"></script>
<script>
layui.use(['form'],function(){
	var form = layui.form;
	form.render();
	form.on('select(city)', function(data){	
		obj = data.elem[data.elem.selectedIndex];
		if(obj.value==''){return false};
		$.get('<{:U('house/getSubway')}>',{cityID:obj.value,fid:0},function(res){
			if (res.status==1){
				var data = res.results.data;
				_html = '<option value="">请选择</option>';
				for(var i in data){
					_html += '<option value="'+data[i]['id']+'">'+data[i]['name']+'</option>';
				}
				$("#c2").html(_html);				
			}else{
				$("#c2").html('');
				$("#c3").html('');
			}
			form.render();
		},'json')
	});

	form.on('select(subway)', function(data){	
		obj = data.elem[data.elem.selectedIndex];
		if(obj.value==''){return false};
		$.get('<{:U('house/getLine')}>',{fid:obj.value},function(res){
			if (res.status==1){
				var data = res.results.data;
				_html = '';
				for(var i in data){
					_html += '<option value="'+data[i]['id']+'">'+data[i]['name']+'</option>';
				}
				$("#c3").html(_html);				
			}else{
				$("#c3").html('');
			}
			form.render();
		},'json')
	}); 

	$('#addBtn').click(function(){
		if ($("#c3").val()!=''){
			str = $("#c2").find("option:selected").text()+"-"+$("#c3").find("option:selected").text();
			if ($("#subway").val()==""){
				$("#subway").val(str);
			}else{
				$("#subway").val($("#subway").val()+","+str);
			}			
		}
	})
})
</script>